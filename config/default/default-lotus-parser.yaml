# ===============================================================================
# Lotus解析器配置 - B站视频解析与下载
# ===============================================================================
# 使用说明：
# 1. BBDown模式：需要安装BBDown工具，支持会员内容和高画质
# 2. API模式：直接使用B站API，不需要外部工具但功能有限
# 3. 智能画质：自动根据文件大小降低画质，防止超出限制
# 4. 多分P支持：使用 #p[序号] 指令选择具体分P
# 5. 自动清理：发送成功后自动删除临时文件
#
# 核心功能：
# - B站视频/直播解析：支持BV号、短链接、直播房间链接
# - 智能画质选择：自动根据文件大小降级至适当画质
# - BBDown集成：二维码登录、会员视频解析、多格式输出
# - 媒体处理：音视频分离下载、ffmpeg合并、格式转换
# - 内容展示：封面/简介/播放数据/AI摘要可配置显示

# ---------------- B站解析配置 ----------------
bilibili:
  # [认证] 登录B站后获取的SESSDATA Cookie值
  # 优先级最高，会覆盖BBDown的自动获取。支持会员视频和高画质解析
  # 获取方法：登录B站后从浏览器开发者工具中Cookies里找到SESSDATA
  sessData: ""
  
  # [核心] 是否优先使用 BBDown 工具进行下载
  # 启用后可解析会员内容、获取更高画质、更可靠的下载
  # 需要在 external_tools.toolsPath 中配置 BBDown.exe 路径
  # 关闭后将使用 B站 API 模式（功能有限但无需外部工具）
  useBBDown: true
  
  # [核心] 默认下载画质（同时适用于BBDown和API模式）
  # 画质对应关系：
  # - 120: 4K/8K 超高清  - 116: 1080P 60帧  - 112: 1080P 高码率
  # - 80:  1080P 高清     - 74:  720P 60帧   - 64:  720P 高清
  # - 32:  480P 清晰      - 16:  360P 流畅
  # 注意：高画质需要会员或特定权限，建议默认使用 64 (720P)
  resolution: 64
  
  # [限制] 视频时长限制（秒），超过则只发送信息不下载视频
  # 3600秒 = 1小时，可根据网络环境和存储空间调整
  durationLimit: 3600

  # [限制] 视频文件大小上限（单位MB），超过则不下载视频仅发送信息
  # 设置为 0 表示无限制，但建议设置合理值防止占用过多存储空间
  fileSizeLimit: 0

  # [智能画质] 自动画质降级功能配置
  # 功能说明：当视频文件超过指定大小时，自动尝试降低画质到适合大小
  # 优点：防止文件过大、提高下载成功率、自动优化网络传输
  smartQuality:
    # 是否启用智能画质降级功能
    enable: true
    
    # 自动降级触发阈值（单位MB）
    # 当视频文件大小超过此值时，将自动尝试使用更低画质
    # 建议设置为 50-200MB之间，根据网络环境调整
    autoDowngradeThreshold: 100
    
    # 画质降级优先级列表（按从高到低的顺序尝试）
    # 自动跳过比默认下载画质(resolution)更高的选项
    # 画质对应：120=4K, 116=1080P60, 112=1080P高码率, 80=1080P, 74=720P60, 64=720P, 32=480P, 16=360P
    # 默认包含所有主流画质，可根据需要调整
    qualityPriority: [116, 112, 80, 74, 64, 32, 16]
    
    # 是否显示画质降级提示消息
    # 开启后，当发生画质降级时会向用户显示“智能画质降级: 1080P → 720P”类似提示
    showDowngradeNotice: true
    
    # BBDown预检查超时时间（秒）
    # 用于获取视频信息的最大等待时间，避免网络问题导致长时间等待
    # 设置过短可能导致检查失败，过长会影响用户体验
    precheckTimeout: 15

  # [内容展示] 视频信息显示选项配置
  # 可根据群聊环境和用户偏好选择性开启/关闭各项内容
  
  # 是否显示视频封面图片（建议开启，提高用户体验）
  displayCover: true
  
  # 是否显示视频统计信息（播放量/弹幕数/点赞数等）
  displayInfo: true
  
  # 是否显示视频简介内容（关闭可减少消息长度）
  displayIntro: true
  
  # 视频简介显示的最大字符数，超出部分将被省略
  # 防止简介过长影响消息阅读体验
  introLenLimit: 120
  
  # 是否显示B站AI生成的视频摘要（需要有效的SESSDATA）
  # 注意：此功能可能受B站接口策略影响，且需要额外的网络请求
  displaySummary: false
  

# ---------------- 外部工具配置 ----------------
external_tools:
  # [系统平台] 当前运行的系统平台
  # 用于自动选择对应的BBDown可执行文件
  # 可选值：
  # - "win64": Windows 64位系统，使用 winx64/BBDown.exe
  # - "linux64": Linux 64位系统，使用 linux64/BBDown
  # 注意：请根据实际运行环境选择正确的平台
  platform: "linux64"
  
  # [BBDown路径] BBDown工具的完整路径配置
  # 根据platform自动选择对应的可执行文件
  # 路径结构：
  # - Windows: plugins/yunzai-plugin-integration/winx64/BBDown.exe
  # - Linux: plugins/yunzai-plugin-integration/linux64/BBDown
  bbdownPath:
    win64: "plugins/yunzai-plugin-integration/resources/BBDown/winx64/BBDown.exe"
    linux64: "plugins/yunzai-plugin-integration/resources/BBDown/linux64/BBDown"
  
  # [FFmpeg路径] FFmpeg工具路径（可选）
  # 用于音视频合并、格式转换、压缩处理
  # 留空时将从系统环境变量(PATH)中搜索
  # 建议使用绝对路径确保稳定性
  ffmpegPath: ""

# ---------------- 通用配置 ----------------
general:
  # [标识] 解析成功时消息的前缀标识
  # 用于区分Lotus插件解析的消息与其他消息，方便用户识别
  identifyPrefix: ""
  
  # [传输] 视频文件传输方式阈值（单位MB）
  # 当视频文件大小超过此值时，将转为上传群文件而非直接发送
  # 群文件传输速度更快且不占用聊天记录空间，但无法直接预览
  # 建议设置为 80-150MB，根据群成员网络环境调整
  videoSizeLimit: 100
