# Telegram 监听与转发默认配置（首次运行会复制为 config/tg-config.yaml）
# 使用说明：
# 1. 先到 @BotFather 创建 Bot 并获取 token
# 2. 将 Bot 添加到目标频道中，获取频道 ID 或 用户名
# 3. 配置频道与 QQ 群/私聊的映射关系
# 4. 发送 #tg 指令手动拉取频道消息并转发到QQ
# 
# 核心功能：
# - 指令触发拉取：#tg / #tg拉取 / #拉取tg
# - 多媒体下载：支持文本/图片/视频/文档/音频
# - 云端优先：所有消息优先通过云端API处理，失败后回退本地
# - 智能转发：按QQ消息格式转换，支持合并转发
# - 去重机制：避免重复转发历史消息
# - 代理支持：所有Telegram API请求均可走代理

# [必填] Telegram Bot Token，到 @BotFather 获取
token: ""

# [可选] 代理配置，用于访问 Telegram API（国外服务器可不用）
proxy:
  enable: true            # 是否启用代理
  protocol: http           # 代理协议：http 或 https
  host: 127.0.0.1          # 代理主机地址
  port: 7890               # 代理端口号

# [性能] 批量转发配置，避免单条发送刷屏
batch:
  size: 64                  # 每批合并转发的消息数量（过大可能被QQ风控）

# [性能] 去重配置，避免重复处理历史消息
dedup:
  ttl_days: 2              # 去重数据保留天数，超过即自动清理

# [存储] 下载和文件管理配置
download:
  dir: plugins/yunzai-plugin-integration/data/temp/tg  # 媒体文件临时下载目录
  max_file_mb: 20                               # 单文件最大下载大小（MB），超过则跳过下载
  auto_cleanup: true                            # 是否启用自动清理
  cleanup_days: 7                               # 清理超过指定天数的文件

# [云端API] 分布式下载配置（云端优先策略：所有消息都先尝试云端API）
cloud_teelebot:
  enabled: false                                # 是否启用云端teelebot API（需要单独部署）
  api_endpoint: "http://localhost:31955"         # 云端API服务地址
  auth_token: ""                                # API认证token（与teelebot FileLinker插件配置保持一致）
  timeout: 30                                   # API请求超时时间（秒）
  retry_count: 3                                # 失败重试次数
  retry_delay: 5                                # 重试延迟（秒）
  health_check_cache: 30                        # 健康检查缓存时间（秒）
  max_batch_size: 10                            # 批量请求最大文件数
  download_timeout: 300                         # 文件下载超时时间（秒）
  max_file_size: 2147483648                     # 云端最大文件大小（字节，默认2GB）
  max_concurrent_downloads: 3                   # 最大并发下载数
  fallback_to_local: true                       # 云端失败时是否回退到本地下载
  force_cloud: false                            # 是否强制使用云端模式（已默认云端优先）
  local_max_mb: 20                              # 本地下载最大大小（MB）
  cloud_max_mb: 2000                            # 云端下载最大大小（MB）
  cloud_preferred_types: [video, document]     # 优选云端下载的文件类型（已改为全部优先）

# [日志] 输出级别控制
logging:
  detailed: false          # 是否输出DEBUG级别的详细日志信息

# [过滤] 内容过滤器配置，用于清理不需要的内容
filters:
  enable: true             # 是否启用内容过滤器
  remove_telegram_domains: true  # 是否过滤Telegram相关域名（替换为 https://）
  telegram_domains:        # Telegram相关域名列表，可按需添加
    - t.me
    - telegram.me
    - telegram.org
    - telegra.ph

# [核心] 频道与 QQ 目标的映射关系配置（支持多个频道）
# 注意：
# - id 和 username 选择一个填写即可，id 优先级更高
# - 频道 ID 获取方法：将 Bot 添加到频道中，然后查看 chat.id
# - types 支持：text(文本), photo(图片), video(视频), document(文档), audio(音频)
# 频道配置（可以为空数组，或配置多个频道）
# 配置示例：
channels:
  - id: ""                    # 频道ID（可为空，如: -1001234567890）
    username: ""             # 频道用户名（可为空，不包含@）
    types: [text, photo, video, document, audio]  # 要同步的消息类型
    target:
      type: group           # 目标类型: group(群聊) 或 user(私聊)
      id: 123456789         # QQ群号或QQ号
