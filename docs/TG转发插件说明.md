# TG转发插件使用说明

## 📋 功能概述

这是一个用于Telegram频道消息转发到QQ群的插件，支持：
- 📺 **频道监控**: 定时监控指定Telegram频道
- 🖼️ **媒体转发**: 自动下载图片、视频并转发
- 📱 **合并消息**: 将多条消息合并转发到QQ群
- 🔧 **灵活配置**: 支持代理、文件大小限制等
- 🎛️ **锅巴界面**: 可视化配置所有参数

## 🚀 快速开始

### 1. 创建Telegram Bot
1. 联系 [@BotFather](https://t.me/BotFather) 创建Bot
2. 获得Bot Token (格式: `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11`)
3. 将Bot添加到要监控的频道(需要管理员权限)

### 2. 配置插件
在锅巴管理面板中找到 "TG转发插件配置"：

- **Bot Token**: 填入从BotFather获得的Token
- **监控频道**: 输入频道用户名，如 `@channelname`
- **目标QQ群**: 输入要转发到的QQ群号
- **监控间隔**: 设置检查新消息的时间间隔(分钟)
- **代理设置**: 如果需要代理访问Telegram，配置代理地址

### 3. 启用功能
保存配置后，插件会自动开始监控。

## 🎮 指令说明

### 主人专用指令
- `#拉取tg` - 手动触发拉取并刷新监控间隔
- `#tg状态` - 查看转发状态和配置信息
- `#停止tg` - 停止自动监控

## ⚙️ 配置说明

### 代理配置示例
```yaml
proxy:
  enabled: true
  url: "http://127.0.0.1:7890"    # HTTP代理
  # url: "socks5://127.0.0.1:1080" # SOCKS5代理
```

### 文件处理
- 最大支持50MB文件(Telegram Bot API限制)
- 超过限制的文件将被跳过
- 转发完成后自动清理临时文件

### 监控间隔
- 建议设置为60分钟或以上
- 过于频繁可能触发API限制
- 可通过`#拉取tg`手动刷新

## 📁 文件结构
```
plugins/yunzai-plugin-integration/
├── app/tg/
│   └── tg-forwarder.js         # 主功能文件
├── config/
│   └── tg-forwarder.yaml       # 配置文件
├── model/tg/
│   └── tg-setting.js           # 配置管理
├── data/
│   └── tg-last-update.json     # 上次更新记录
└── temp/tg/                    # 临时文件目录
```

## 🔧 故障排除

### 常见问题

**1. Bot无法获取频道消息**
- 确认Bot已添加到频道
- 确认频道为公开频道或Bot有权限
- 检查Bot Token是否正确

**2. 网络连接失败**
- 检查网络连接
- 确认代理设置正确
- 尝试更换代理节点

**3. 文件下载失败**
- 检查文件大小是否超过50MB
- 确认网络稳定
- 检查磁盘空间

**4. 转发到QQ群失败**
- 确认机器人在目标群内
- 检查群号是否正确
- 确认机器人有发送权限

### 日志查看
查看Yunzai控制台日志，关键词：`[TG转发]`

## 🔒 安全注意

- Bot Token属于敏感信息，请妥善保管
- 建议定期更新Bot Token
- 避免在公开场所暴露配置信息

## 📝 更新日志

### v1.0.0
- ✨ 首次发布
- 🎯 支持频道监控和消息转发
- 🖼️ 支持图片、视频下载转发
- 🔧 集成锅巴配置界面
- 🌐 支持HTTP/SOCKS5代理